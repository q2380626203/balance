# GY-25T 陀螺仪通信协议

## 协议概述

GY-25T陀螺仪采用串口通信，使用Modbus RTU类似的协议格式进行数据传输。

## 数据帧格式

| 字段名称 | 字节数 | 说明 |
|---------|--------|------|
| 帧头ID | 1字节 | 设备地址标识 |
| 功能码 | 1字节 | 操作类型标识 |
| 内部寄存器起始地址 | 1字节 | 读取的起始寄存器地址 |
| 读寄存器数量 | 1字节 | 需要读取的寄存器数量 |
| 数据 | N字节 | 实际的寄存器数据 |
| 校验和 | 1字节 | 前面所有字节相加的低8位 |

## 字段详细说明

### 帧头ID（1字节）
- **功能**: 设备地址标识，内部寄存器地址0的数据
- **默认值**: 0xA4
- **说明**: 当多个模块连接到同一总线时，可以修改此值进行区分

### 功能码（1字节）
- **0x03**: 读寄存器指令
- **说明**: 表示这一帧是读取寄存器的指令

### 内部寄存器起始地址（1字节）
- **功能**: 指定读取的起始寄存器地址
- **参考**: 寄存器地址表格及内部数据功能
- **示例**: 0x18表示从yaw角寄存器开始读取

### 读寄存器数量（1字节）
- **功能**: 指定从起始地址开始需要读取多少个寄存器
- **计算**: 从起始地址开始计算的寄存器数量
- **示例**: 0x02表示读取2个字节的数据

### 校验和（1字节）
- **计算方法**: 一帧数据前面所有字节相加之和，保留低8位
- **公式**: checksum = (帧头ID + 功能码 + 起始地址 + 数据长度 + 所有数据字节) & 0xFF

## 常用寄存器地址

| 地址 | 功能 | 数据类型 | 说明 |
|------|------|----------|------|
| 0x18 | yaw_h | uint8_t | 航向角数据高8位 |
| 0x19 | yaw_l | uint8_t | 航向角数据低8位 |
| 0x1A | pitch_h | uint8_t | 俯仰角数据高8位 |
| 0x1B | pitch_l | uint8_t | 俯仰角数据低8位 |
| 0x1C | roll_h | uint8_t | 横滚角数据高8位 |
| 0x1D | roll_l | uint8_t | 横滚角数据低8位 |

## 数据包示例

### YAW角数据包
```
A4 03 18 02 00 01 C2
```

**解析**:
- `A4`: 帧头ID
- `03`: 功能码（读寄存器）
- `18`: 起始地址（yaw_h寄存器）
- `02`: 读取数量（2个字节）
- `00 01`: yaw角数据（高字节00，低字节01）
- `C2`: 校验和

**校验和计算**:
```
checksum = (0xA4 + 0x03 + 0x18 + 0x02 + 0x00 + 0x01) & 0xFF
         = 0x1C2 & 0xFF
         = 0xC2
```

## 角度数据转换

### YAW角度计算
```c
int16_t yaw_raw = (yaw_h << 8) | yaw_l;
float yaw_angle = yaw_raw / 100.0f;  // 转换为度数
```

### 角度范围
- **YAW角**: -180.00° ~ +180.00°
- **PITCH角**: -90.00° ~ +90.00°
- **ROLL角**: -180.00° ~ +180.00°

## 通信参数

- **波特率**: 115200 bps
- **数据位**: 8位
- **停止位**: 1位
- **校验位**: 无
- **数据更新频率**: 可配置，通常100Hz